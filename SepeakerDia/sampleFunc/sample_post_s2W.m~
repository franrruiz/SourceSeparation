function s2H = sample_post_s2W(data,samples,hyper,param)

if(~param.infer.sampleVarW)
    s2H = samples.s2H;
    return;
end

% Obtain parameters from the structs
Nr = param.D;
[Nt T] = size(samples.Z);

% Posterior parameters
nuP = hyper.nuW+Nt*Nr/2;
tauP = tau0+squeeze(sum(sum(abs(samples.H).^2,1),2)).';

% Sample the variance from an Inverse-Gamma distribution
s2H = 1./gamrnd(nuP,1./tauP);
