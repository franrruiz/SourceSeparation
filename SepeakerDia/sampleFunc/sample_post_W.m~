function [P] = sample_post_W(data,samples,hyper,param)

% Obtain parameters from the structs
[Nt T] = size(samples.Z);
D=param.D;
ZZ=samples.Z*samples.Z';
for d=1:D
    PrecW=((1/samples.s2y)* ZZ+ 1/hyper.s2W*diag(ones(Nt,1)));
    MuW= PrecW\(1/samples.s2y*(S*data.obs');

    
end


Paux = mvnrnd2(MuP,inv(PrecP),1);


P=reshape(Paux,Nt,Q)';



